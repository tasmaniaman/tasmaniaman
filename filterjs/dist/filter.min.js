/*
 * filter.js
 * 2.1.0 (2020-06-23)
 *
 * Released under the MIT license
 * http://opensource.org/licenses/MIT
 *
 * Copyright 2011-2020 Jiren Patel[jirenpatel@gmail.com]
 *
 * Dependency:
 *  jQuery(v1.9 >=)
 */
/*
 * JsonQuery
 * 0.0.2 (2015-08-06)
 *
 * Released under the MIT license
 * http://opensource.org/licenses/MIT
 *
 * Copyright 2011-2015 Jiren Patel[jirenpatel@gmail.com]
 *
 */
!function(t){"use strict";function e(t,e){return new i(t,e||{})}(t.JsonQuery=e).VERSION="0.0.2",e.Config={id:"id",latitude:"latitude",longitude:"longitude",date_regx:/^\d{4}-\d{2}-\d{2}$/},e.blankClone=function(t,e){return new i(e,{getterFns:t.getterFns,schema:t.schema,id:t.id,latitude:t.latitude,longitude:t.longitude})};function p(t,e,i){if(t.length===+t.length)for(var r=0,n=t.length;r<n;r++)e.call(i,t[r],r);else for(var s in t)hasOwnProperty.call(t,s)&&e.call(i,t[s],s)}function h(t){if(null==t)return"String";
/*
     * @info Fix for IE 10 & 11
     * @bug Invalid calling object
     */var e=Object.prototype.toString.call(t).slice(8,-1);return"String"==e&&t.match(r.date_regx)?"Date":e}var r=e.Config,i=function(t,e){this.records=t||[],this.getterFns=e.getterFns||{},this.lat=e.latitude||r.latitude,this.lng=e.longitude||r.longitude,this.id=e.id,e.schema&&(this.schema=e.schema),this.records.length&&!this.schema&&s(this,t[0],e.schema)},n=i.prototype,s=function(t,e,i){t.schema={},t.id||(t.id=e._id?"_id":r.id),i||(a.call(t,e),c.call(t,e))},a=function(t,e){var i,r,n,s;for(i in t)s=t[i],r=h(s),n=e?e+"."+i:i,"Object"==(this.schema[n]=r)?a.call(this,s,n):"Array"==r&&(-1<["Object","Array"].indexOf(h(s[0]))?a.call(this,t[i][0],n):this.schema[n]=h(s[0]))},c=function(t){var e,i,r;for(e in this.schema){i=this.schema[e];try{this.getterFns[e]||(this.getterFns[e]=o.call(this,e,i)),
//Remap if it is array
r=this.getterFns[e](t),"Array"==h(r)&&(this.schema[e]="Array")}catch(t){console.log("Error while generating getter function for selector : "+e+" NOTE: Define manually")}}},o=function(t,e){for(var i,r,n,s="",a=t.split("."),h=function(t,e){for(var i=0,r=0,n=e.length-1,s=e.length-1;0<=s;s--)"Array"==t[e.slice(0,s+1).join(".")]&&s<n&&(i=s,r+=1);return 1<r?i+1:-1}(this.schema,a),c=a.length-1;0<=c;c--)i=a.slice(0,c+1).join("."),r="['"+a[c]+"']",s="Array"==this.schema[i]?h==c?r+(s.length?".every(function(r"+c+"){  objs.push(r"+c+s+")})":""):r+(s.length?".map(function(r"+c+"){  return r"+c+s+"})":""):r+s;return n=-1<h?"var objs = []; obj"+s+";"+("Date"==this.schema.path?"return parseDate(objs)":"return objs;"):"return "+("Date"==this.schema.path?"parseDate(obj"+s+");":"obj"+s+";"),new Function("obj",n)};n.operators={eq:function(t,e){return t==e},ne:function(t,e){return t!=e},lt:function(t,e){return t<e},lte:function(t,e){return t<=e},gt:function(t,e){return e<t},gte:function(t,e){return e<=t},in:function(t,e){return-1<e.indexOf(t)},ni:function(t,e){return-1==e.indexOf(t)},li:function(t,e){return e.test(t)},bt:function(t,e){return t>=e[0]&&t<=e[1]}},n.addOperator=function(t,e){this.operators[t]=e};function l(t,e,i){for(var r=0,n=t.length;r<n;r++)if(i(t[r],e))return!0}n.addCondition=function(t,e){this.operators[t]=e},n.getCriteria=function(t){var e=t.split(".$");return{field:e[0],operator:e[1]||"eq"}},n.setGetterFn=function(t,e){this.getterFns[t]=e},n.addRecords=function(t){return!(!t||!t.length)&&("Array"==h(t)?this.records=this.records.concat(t):this.records.push(t),this.schema||s(this,t[0]),!0)},n._findAll=function(t,e,i,r){var n,s,a,h=[],c=this.getterFns[e];return"li"==r&&"string"==typeof i&&(i=new RegExp(i)),n=this.operators[r],"Array"==this.schema[e]&&(a=n,n=l),p(t,function(t){s=c(t),n(s,i,a)&&h.push(t)}),h},n.find=function(t,e){var i,r;return e||(e=t,t=this.id),r=this.getterFns[t],function(t,e,i){for(var r=0,n=t.length;r<n;r++)if(!1===e.call(i,t[r],r))return}(this.records,function(t){if(r(t)==e)return i=t,!1}),i},p(["where","or","groupBy","select","pluck","limit","offset","order","uniq","near"],function(i){n[i]=function(t){var e=new d(this,this.records);return e[i].apply(e,arguments),e}}),p(["update_all","destroy_all"],function(i){n[i]=function(t){var e=new d(this,this.records);return e[i].apply(e,arguments)}}),p(["count","first","last","all"],function(t){Object.defineProperty(n,t,{get:function(){return new d(this,this.records)[t]}})});function u(t,e,i){for(var r=0,n=i.length;r<n;r++)if(this.getterFns[i[r]](t)!==this.getterFns[i[r]](e))return!1;return!0}function f(t,e){var i,r,n;for(i in t)r=this.jQ.getCriteria(i),n=this.jQ._findAll(n||e,r.field,t[i],r.operator);return n}function g(n,t){var s=[],a=this;return"Object"!=h(t[0])?p(t,function(t){-1==s.indexOf(t)&&s.push(t)}):(s.push(t[0]),p(t,function(t){for(var e=!1,i=0,r=s.length;i<r;i++)u.call(a.jQ,s[i],t,n)&&(e=!0);e||s.push(t)})),s}var d=function(t,e){return this.jQ=t,this.records=e,this.criteria={},this},v=d.prototype;v.each=function(t,e){p(this.exec()||[],t,e)},v.exec=v.toArray=function(t){var e;return this.criteria.all&&(e=this.records),this.criteria.where&&(e=f.call(this,this.criteria.where,e||this.records)),this.criteria.or&&(e=e.concat(f.call(this,this.criteria.or,this.records)),e=g.call(this,[this.jQ.id],e)),this.criteria.order&&(e=function(t,e){for(var n,s,i=e.slice(0),r=0,a=t.length;r<a;r++)n=this.jQ.getterFns[t[r].field],s="asc"==t[r].direction?1:-1,i.sort(function(t,e){var i=n(t),r=n(e);return(i<r?-1:r<i?1:0)*s});return i}.call(this,this.criteria.order,e||this.records)),this.criteria.near&&(e=b.call(this,this.criteria.near,e||this.records)),this.criteria.uniq&&(e=g.call(this,this.criteria.uniq,e||this.records)),this.criteria.select&&(e=function(t,e){var r,n=this,s=[];return p(t,function(i){r=n.jQ.getterFns[i],p(e,function(t,e){(s[e]||(s[e]={}))[i]=r(t)})}),s}.call(this,this.criteria.select,e||this.records)),this.criteria.pluck&&(e=function(t,e){var i=this.jQ.getterFns[t],r=[];return p(e,function(t){r.push(i(t))}),r}.call(this,this.criteria.pluck,e||this.records)),this.criteria.limit&&(e=(e||this.records).slice(this.criteria.offset||0,(this.criteria.offset||0)+this.criteria.limit)),this.criteria.group_by&&(e=function(t,e){var i,r=this.jQ.getterFns[t],n={};e.length;return p(e,function(t){i=r(t),(n[i]||(n[i]=[])).push(t)}),n}.call(this,this.criteria.group_by,e||this.records)),e=e||this.records,t&&p(e,t),this.jQ.onResult&&this.jQ.onResult(e,this.criteria),e};function m(t,e){var i;for(i in this.criteria[t]||(this.criteria[t]={}),e)this.criteria[t][i]=e[i];return this}v.where=function(t){return m.call(this,"where",t)},v.or=function(t){return m.call(this,"or",t)},v.groupBy=function(t){return this.criteria.group_by=t,this},v.select=function(){return this.criteria.select=arguments,this},v.pluck=function(t){return this.criteria.pluck=t,this},v.limit=function(t){return this.criteria.limit=t,this},v.offset=function(t){return this.criteria.offset=t,this},v.order=function(t){var e;for(e in this.criteria.order=this.criteria.order||[],t)this.criteria.order.push({field:e,direction:t[e].toLowerCase()});return this},v.uniq=function(){return this.criteria.uniq=!(0<arguments.length)||arguments,this},Object.defineProperty(v,"count",{get:function(){this.criteria.count=!0;var t=this.exec();return"Array"==h(t)?this.exec().length:Object.keys(t).length}}),Object.defineProperty(v,"all",{get:function(){return this.criteria.all=!0,this.exec()}}),Object.defineProperty(v,"first",{get:function(){return this.criteria.first=!0,this.exec()[0]}}),Object.defineProperty(v,"last",{get:function(){this.criteria.last=!0;var t=this.exec();return t[t.length-1]}});
//Geocoding
var _=6371,P=function(t){return t*Math.PI/180},b=function(c,t){var o=[],l="mile"==c.unit?.6214:1,u=this.jQ.getterFns[this.jQ.lat],f=this.jQ.getterFns[this.jQ.lng];return p(t,function(t){var e,i,r,n,s,a,h;t._distance=(e=u(t),i=c.lat,r=f(t),n=c.lng,s=P(i-e),a=P(n-r),e=P(e),i=P(i),h=Math.sin(s/2)*Math.sin(s/2)+Math.sin(a/2)*Math.sin(a/2)*Math.cos(e)*Math.cos(i),2*Math.atan2(Math.sqrt(h),Math.sqrt(1-h))*_*l),t._distance<=c.distance&&o.push(t)}),o.sort(function(t,e){return t._distance<e._distance?-1:t._distance>e._distance?1:0}),o};v.near=function(t,e,i,r){return this.criteria.near={lat:t,lng:e,distance:i,unit:r||"km"},this},
//Helpers
v.map=v.collect=function(e){var i,r=[];return this.exec(function(t){(i=e(t))&&r.push(i)}),r},v.sum=function(t){var i,r=0,n=this.jQ.getterFns[t];return this.criteria.group_by&&(i=!0,r={}),this.exec(function(t,e){i?(r[e]=0,p(t,function(t){r[e]=r[e]+(n(t)||0)})):r+=n(t)||0}),r},v.toJQ=function(){var t=e(this.all,{schema:!0});return t.schema=this.jQ.schema,t.getterFns=this.jQ.getterFns,t},v.destroy_all=v.destroy=function(){var t=this.all;return p(t,function(t,e){t._destroy_=!0}),this.records=this.jQ.records=this.records.filter(function(t){return!t._destroy_}),t},v.update_all=v.update=function(t){if(!t)return!1;var e=0;return p(this.all,function(i){p(t,function(t,e){i[e]=t}),e+=1}),e},
//In IE 8 indexOf method not define.
Array.prototype.indexOf||(Array.prototype.indexOf=function(t,e){for(var i=e||0,r=this.length;i<r;i++)if(this[i]===t)return i;return-1}),Object.defineProperty||(Object.defineProperty=function(t,e,i){t[e]=i.get})}(this),function(h,t,r){"use strict";
//View Template
// Ref: Underscopre.js
//JavaScript micro-templating, similar to John Resig's implementation.
var s={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};function n(t,e){var i=s,r="var __p=[],print=function(){__p.push.apply(__p,arguments);};with(obj||{}){__p.push('"+t.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(i.escape,function(t,e){return"',escapeStr("+e.replace(/\\'/g,"'")+"),'"}).replace(i.interpolate,function(t,e){return"',"+e.replace(/\\'/g,"'")+",'"}).replace(i.evaluate||null,function(t,e){return"');"+e.replace(/\\'/g,"'").replace(/[\r\n\t]/g," ")+";__p.push('"}).replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');}return __p.join('');",n=new Function("obj",r);return e?n(e):function(t){return n(t)}}function a(t,e,i){var r=this;this.opts=i||{},this.callbacks=this.opts.callbacks||{},this.$container=h(e),this.view=this.opts.view||c,this.criterias=[],this._index=1,this.appendToContainer=this.opts.appendToContainer||o,this.has_pagination=!!this.opts.pagination,this.search_text="",this.anyFilterSelected=!1,this.setTemplate(this.opts.template),h.each(this.opts.criterias||[],function(){r.addCriteria(this)}),this.Model=JsonQuery(),this.Model.getterFns._fid=function(t){return t._fid},this.addRecords(t,this.opts.filter_on_init||!1),this.has_pagination&&this.initPagination()}var e=a.prototype;Object.defineProperty(e,"records",{get:function(){return this.Model.records}}),Object.defineProperty(e,"recordsCount",{get:function(){return this.Model.records.length}}),e.templateBuilder=n,
//Callback
e.execCallback=function(){var t=arguments[0];this.callbacks[t]&&this.callbacks[t].apply(this,Array.prototype.slice.call(arguments,1))},e.addCallback=function(t,e){t&&e&&(this.callbacks[t]=e)},
//Add Data
e.addRecords=function(t,e){this.Model.schema;this.execCallback("beforeAddRecords",t),this.Model.addRecords(t)&&(this.has_scheme||this.initSearch(this.opts.search),this.render(t),!1!==e&&this.filter()),this.execCallback("afterAddRecords",t)},e.removeRecords=function(t){var e;if(h.isPlainObject(t)?e=this.Model.where(t).pluck("_fid").all:h.isArray(t)&&(e=this.Model.where({"id.$in":t}).pluck("_fid").all),!e)return!1;for(var i,r=this.Model.records,n=0,s=e.length,a=r.length-1;-1<a&&(i=r[a]._fid,-1<e.indexOf(i)&&(r.splice(a,1),n++,h("#fjs_"+i).remove()),n!=s);a--);return this.execCallback("afterRemove"),!0};var c=function(t,e){return this.templateFn(t)};e.render=function(t){var e=this;t.length&&(this.execCallback("beforeRender",t),h.each(t,function(t){e.execCallback("beforeRecordRender",this),this._fid=e._index++,e.has_pagination||e.renderItem(this,t)}))},e.renderItem=function(t,e){var i;t&&("string"==typeof(i=this.view(t,e))&&(i=h(h.trim(i))),i.attr("id","fjs_"+t._fid).addClass("fjs_item"),this.appendToContainer(i,t))};var o=function(t,e){this.$container.append(t)};e.addCriteria=function(t){var e=this;return!!t&&(h.isArray(t)?h.each(t,function(){i.call(e,this)}):i.call(e,t),!0)};
// Add Filter criteria
// criteria: { ele: '#name', event: 'check', field: 'name', type: 'range' }
var i=function(t){return!!(t&&t.field&&t.ele)&&(t.$ele=h(t.ele),!!t.$ele.length&&(i=(e=t).$ele,r=e.$ele.attr("type"),e.selector||("INPUT"==i.get(0).tagName?e.selector="checkbox"==r||"radio"==r?":checked":":input":"SELECT"==i.get(0).tagName&&(e.selector="select")),e.event||(e.event="checkbox"==r||"radio"==r?"click":"change"),t=e,this.bindEvent(t.ele,t.event),t._q=t.field+("range"==t.type?".$bt":""),t.active=!0,this.criterias.push(t),!0));var e,i,r};e.removeCriteria=function(e){var t,i;h.each(this.criterias,function(t){this.field==e&&(i=t)}),null!=i&&(t=this.criterias.splice(i,1)[0],h("body").off(t.event,t.ele))};function l(t,e){var i=this;t&&(h.isArray(t)||(t=[t]),h.each(t,function(){var t=this;h.each(i.criterias,function(){this.field==t&&(this.active=e)})}))}e.deactivateCriteria=function(t){l.call(self,t,!1)},e.activateCriteria=function(t){l.call(this,t,!0)},e.getSelectedValues=function(t,e){var i=[];if(t.$ele.filter(t.selector).each(function(){i.push(h(this).val())}),h.isArray(i[0])&&(i=[].concat.apply([],i)),!(t.all&&-1<i.indexOf(t.all)))return"range"==t.type&&(i=i[0].split(t.delimiter||"-")),i=this.parseValues(t.field,i),e.execCallback("onFilterSelect",{criteria:t,values:i})||i},e.lastResult=function(){return this.last_result||this.records},e.filter=function(){var t,e,i,r={},n=0,s=this;return h.each(this.criterias,function(){this.active&&(t=s.getSelectedValues(this,s))&&t.length&&(e=h.isArray(t)&&!this.type?this._q+".$in":this._q,r[e]=t,n+=1)}),this.anyFilterSelected=0<n,i=this.Model.where(r),this.execCallback("shortResult",i),this.last_result=i.all,this.searchFilter(this.last_result)||(this.show(this.last_result),this.renderPagination(this.last_result.length),this.execCallback("afterFilter",this.last_result,JsonQuery.blankClone(this.Model,this.last_result))),r},e.show=function(t,e){var i=0,r=t.length;if(this.has_pagination)for(r=(i=this.page.perPage*(this.page.currentPage-1))+this.page.perPage,this.$container.html("");i<r;i++)this.renderItem(t[i],i);else for(h(".fjs_item").hide();i<r;i++)h("#fjs_"+t[i]._fid).show()},e.filterTimer=function(t){var e=this;this.filterTimeoutId&&clearTimeout(this.filterTimeoutId),this.filterTimeoutId=setTimeout(function(){e.filter()},t)},e.bindEvent=function(t,e){var i=this;h(r).on(e,t,function(t){i.filterTimer(i.opts.timeout||35)})},e.initSearch=function(t){t&&t.ele&&(t.start_length||(this.opts.search.start_length=2),this.$search_ele=h(this.opts.search.ele),this.$search_ele.length&&(this.has_search=!0,this.searchFn=this.buildSearchFn(t.fields),this.bindEvent(t.ele,"keyup")))},e.buildSearchFn=function(t){var e=this,n=[];return t?h.each(t,function(){n.push(e.Model.getterFns[this])}):h.each(e.Model.getterFns,function(t,e){n.push(e)}),function(t,e){t=t.toLocaleUpperCase();for(var i=0,r=n.length;i<r;i++)if(-1<(n[i](e)+"").toLocaleUpperCase().indexOf(t))return!0;return!1}},e.lastSearchResult=function(){return this.search_text.length>this.opts.search.start_length?this.search_result:this.lastResult()},e.searchFilter=function(t){var e;if(this.has_search)return this.search_text=h.trim(this.$search_ele.val()),!(this.search_text.length<this.opts.search.start_length)&&(e=this.search(this.search_text,t||this.lastResult()),this.search_result=e,this.show(e),this.renderPagination(e.length),this.execCallback("afterFilter",e,JsonQuery.blankClone(this.Model,e)),!0)},e.search=function(t,e){t=t.toLocaleUpperCase();for(var i=[],r=0,n=e.length;r<n;r++)this.searchFn(t,e[r])&&i.push(e[r]);return i},
//Streaming
e.setStreaming=function(t){t&&(this.opts.streaming=t).data_url&&(t.stream_after=1e3*(t.stream_after||2),t.batch_size=t.batch_size||!1,this.streamData(t.stream_after))};e.setStreamInterval=function(){var t=this;1!=t.opts.streaming.stop&&(t.streamingTimer=setTimeout(function(){(function(){var e=this,i=this.opts.params||{},t=this.opts.streaming;i.offset=this.recordsCount,t.batch_size&&(i.limit=t.batch_size),this.has_search&&(i.q=h.trim(this.$search_ele.val())),h.getJSON(t.data_url,i).done(function(t){null==i.limit||t&&t.length?(e.setStreamInterval(),e.addRecords(t)):e.stopStreaming()}).fail(function(t){e.stopStreaming()})}).call(t)},t.opts.streaming.stream_after))},e.stopStreaming=function(){this.opts.streaming.stop=!0,this.streamingTimer&&clearTimeout(this.streamingTimer)},e.resumeStreaming=function(){this.opts.streaming.stop=!1,this.streamData(this.opts.streaming.stream_after)},e.streamData=function(t){this.setStreamInterval(),this.opts.streaming.batch_size||this.stopStreaming()},e.clear=function(){this.opts.streaming&&this.stopStreaming(),h.each(this.criterias,function(){h(r).off(this.event,this.ele)}),this.opts.search&&h(r).off("keyup",this.opts.search.ele),this.filterTimeoutId&&clearTimeout(this.filterTimeoutId)},e.initPagination=function(){var i=this,t=this.opts.pagination;t.perPage||(t.perPage={}),t.perPage.values||(t.perPage.values=[10,20,30]),this.page={currentPage:1,perPage:t.perPage.values},this.paginator=new u(this.lastResult().length,this.opts.pagination,function(t,e){i.page={currentPage:t,perPage:e},i.has_search?i.show(i.lastSearchResult()):i.show(i.lastResult())}),this.filter()},e.renderPagination=function(t){this.has_pagination&&this.paginator.setRecordCount(t)},e.parseValues=function(t,e){var i=void 0===this.Model.schema?"String":this.Model.schema[t];return"Number"==i?h.map(e,function(t){return Number(t)}):"Boolean"==i?h.map(e,function(t){return"true"==t||1==t}):e},e.setTemplate=function(t,e){this.templateFn=n(h(t).html()),!0===e&&(this.$container.empty(),this.render(this.records),this.filter())};var u=function(t,e,i){var r;this.recordsCount=t,this.opts=e,this.$container=h(this.opts.container),r=this.opts.paginationView?h(this.opts.paginationView).html():d.pagination,this.paginationTmpl=n(r),this.currentPage=1,this.onPagination=i,this.initPerPage(),this.render(),this.bindEvents()},f=u.prototype;function p(t,e){for(var i=t,r=[];i<=e;i++)r.push(i);return r}f.bindEvents=function(){var e=this;h(this.opts.container).on("click","[data-page]",function(t){e.setCurrentPage(h(this).data("page")),t.preventDefault()})},f.totalPages=function(){return Math.ceil(this.recordsCount/this.perPageCount)},f.setCurrentPage=function(t){t=this.toPage(t),this.prevCurrentPage=this.currentPage,this.currentPage=t,this.paginate(t)},f.setRecordCount=function(t){this.recordsCount=t,this.setCurrentPage(this.currentPage)},f.toPage=function(t){if("first"==t)return 1;if("last"==t)return this.totalPages();if("next"==t){var e=this.currentPage+1;return e>this.totalPages()?this.currentPage:e}if("prev"!=t)return parseInt(t);var i=this.currentPage-1;return i<=0?this.currentPage:i},f.paginate=function(t){this.render(),this.onPagination(this.currentPage,this.perPageCount)},f.render=function(){var t=this.getPages();this.currentPage>t.totalPages&&(this.currentPage=t.totalPages),0==this.currentPage&&(this.currentPage=1),t.currentPage=this.currentPage,this.$container.html(this.paginationTmpl(t))},f.getPages=function(){var t=this.totalPages();if(!this.opts.visiblePages)return{totalPages:t,pages:p(0,t),self:this};var e=Math.floor(this.opts.visiblePages/2),i=this.currentPage-e+1-this.opts.visiblePages%2,r=this.currentPage+e;
// handle boundary case
return i<=0&&(i=1,r=this.opts.visiblePages),t<r&&((i=t-this.opts.visiblePages)<=0&&(i=1),r=t),{currentPage:this.currentPage,totalPages:t,pages:p(i,r),self:this}},f.initPerPage=function(){var t,e,i=this.opts.perPage,r=this;this.perPageCount=i.values[0],t=n(i.perPageView?h(i.perPageView).html():d.per_page)({values:i.values}),h(i.container).html(t),e="SELECT"==h(i.container).find("[data-perpage]").get(0).tagName?"change":"click",h(i.container).on(e,"[data-perpage]",function(t){var e=parseInt(h(this).val()||h(this).data("value"));r.setPerPage(e),t.preventDefault()})},f.setPerPage=function(t){this.perPageCount=t,this.setCurrentPage(this.currentPage)},h.fn.filterjs=function(t,e){var i=h(this);i.data("fjs")||i.data("fjs",v(t,i,e))};var g=[],d=[],v=function(t,e,i){var r=new a(t,e,i);return g.push(r),r};
/*
   * Find html tag and parse options for filter
   */
function m(t,e){var i="fjs-"+t,r=h("["+i+"]"),n=[];if(r.length)return h.each(r,function(){var t=h(this),r={ele:t},e=t.attr(i);if(n.push(r),!e)return n;h.each(e.split(","),function(t,e){var i=e.split("=");r[i[0]]=i[1]})}),e?n:n[0]}v.list=g,v.templateBuilder=n,t.FilterJS=v,d.pagination='<nav>  <ul class="pagination">    <% if(currentPage > 1) { %>      <li> <a href="#" data-page="first" aria-label="First"><span aria-hidden="true">First</span></a> </li>      <li><a href="#" data-page="prev" aria-label="Previous"><span aria-hidden="true">&larr; Previous</span></a></li>    <% } %>    <% for(var i = 0, l = pages.length; i < l; i++ ){ %>      <li class="<%= pages[i] == currentPage ? \'active\' : \'\' %>">        <a href="#" data-page="<%= pages[i] %>"><%= pages[i] %></a>      </li>    <% } %>    <% if( currentPage < totalPages ) { %>      <li><a href="#" data-page="next" aria-label="Next"><span aria-hidden="true">Next &rarr;</span></a></li>      <li><a href="#" data-page="last" aria-label="Last"><span aria-hidden="true">Last</span></a></li>    <% } %>  </ul></nav>',d.per_page='<select size="1" name="per_page" data-perpage="true" class="per-page">  <% for(var i = 0; i < values.length; i++ ){ %>    <option value="<%= values[i] %>"><%= values[i] %></option>  <% } %></select>',v.auto=function(t,e){var i,r,n,s={},a=m("items");if(a&&a.template)return s.template=a.template,(r=m("search"))&&(r.fields&&(r.fields=r.fields.split(",")),s.search=r),e&&(s.callbacks=e),i=v(t,a.ele,s),(n=m("criteria",!0))&&i.addCriteria(n),i}}(jQuery,window,document);